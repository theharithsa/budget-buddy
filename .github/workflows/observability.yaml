
name: "ðŸ“Š OpenTelemetry Observability"
on:
  workflow_run:
    workflows:
      - Deploy OpenTelemetry
      - Deploy to Firebase Hosting on merge
      - Deploy to Firebase Hosting on PR
      - Deploy to Firebase Hosting on PR
    types:
      - completed
jobs:
  telemetry-export:
    name: "ðŸ“ˆ Export Deployment Telemetry Data"
    runs-on: ubuntu-latest
    environment: production
    steps:
      - uses: plengauer/opentelemetry-github/actions/instrument/workflow@v5.24.2
        name: "ðŸ“Š Export OpenTelemetry Workflow Data"
        env:
          OTEL_EXPORTER_OTLP_ENDPOINT: ${{ vars.OTEL_EXPORTER_OTLP_ENDPOINT }}
          OTEL_EXPORTER_OTLP_HEADERS: ${{ secrets.OTEL_EXPORTER_OTLP_HEADERS }}
          OTEL_SERVICE_NAME: finbuddy-observability
          OTEL_SERVICE_VERSION: ${{ github.sha }}
          OTEL_RESOURCE_ATTRIBUTES: "service.name=finbuddy-observability,service.version=${{ github.sha }},deployment.environment=production"
    permissions:
      actions: read
